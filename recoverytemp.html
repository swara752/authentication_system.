<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Password Recovery Flow</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #1a6fc4 0%, #0d4a8a 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 450px;
    }

    /* Forgot Password Container */
    .forgot-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      display: block;
    }

    .forgot-header {
      background: #2575fc;
      color: white;
      padding: 25px 30px;
      text-align: center;
    }

    .forgot-header h1 {
      font-weight: 600;
      font-size: 24px;
      margin-bottom: 5px;
    }

    .forgot-form {
      padding: 30px;
    }

    .form-group {
      margin-bottom: 20px;
      position: relative;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
      font-size: 14px;
    }

    .form-group input {
      width: 100%;
      padding: 14px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 15px;
      transition: all 0.3s;
    }

    .form-group input:focus {
      outline: none;
      border-color: #2575fc;
      box-shadow: 0 0 0 2px rgba(37, 117, 252, 0.2);
    }

    .error-message {
      color: #d9534f;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }

    .continue-button {
      width: 100%;
      padding: 14px;
      background: white;
      color: #2575fc;
      border: 2px solid #2575fc;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .continue-button:hover {
      background: #2575fc;
      color: white;
      transform: scale(1.02);
    }

    .continue-button.clicked {
      background: #2575fc;
      color: white;
      border-color: #2575fc;
    }

    .success-message {
      color: #4caf50;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }
    
    .phone-format {
      font-size: 12px;
      color: #777;
      margin-top: 4px;
      display: block;
    }

    /* Verification Container */
    .verification-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      display: none;
    }

    .verification-header {
      background: #2575fc;
      color: white;
      padding: 20px;
      text-align: center;
    }

    .verification-header h1 {
      font-weight: 600;
      font-size: 22px;
    }

    .verification-form {
      padding: 25px;
    }

    .otp-boxes {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 6px;
    }

    .otp-boxes input {
      width: 40px;
      height: 40px;
      text-align: center;
      font-size: 18px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .otp-boxes input:focus {
      outline: none;
      border-color: #2575fc;
      box-shadow: 0 0 0 2px rgba(37, 117, 252, 0.2);
    }

    .hint {
      font-size: 12px;
      color: #777;
      margin-top: 4px;
      display: block;
      text-align: left;
    }

    .form-group input[type="password"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }

    .match-message {
      font-size: 13px;
      margin-top: 4px;
      text-align: left;
      display: none;
    }

    .register-button {
      width: 100%;
      padding: 14px;
      background: #2575fc;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
    }

    .register-button:hover {
      background: #1a67e8;
    }

    /* Recovery Options Container */
    .recovery-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      display: none;
      animation: fadeIn 0.5s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .recovery-header {
      background: #2575fc;
      color: white;
      padding: 25px 30px;
      text-align: center;
    }

    .recovery-header h1 {
      font-weight: 600;
      font-size: 24px;
      margin-bottom: 5px;
    }

    .recovery-header p {
      font-size: 14px;
      opacity: 0.9;
    }

    .recovery-options {
      padding: 30px;
    }

    .option-card {
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      transition: all 0.3s;
      cursor: pointer;
    }

    .option-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      border-color: #2575fc;
    }

    .option-card.selected {
      border-color: #2575fc;
      background-color: #f5f9ff;
    }

    .option-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .option-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #e6f2ff;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: #2575fc;
      font-size: 20px;
    }

    .option-title {
      font-weight: 600;
      color: #333;
    }

    .option-content {
      display: none;
      margin-top: 15px;
    }

    .option-card.selected .option-content {
      display: block;
    }

    .send-button {
      background: #2575fc;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
    }

    .send-button:hover {
      background: #1a67e8;
      transform: scale(1.02);
    }

    .contact-admin {
      text-align: center;
      margin-top: 10px;
    }

    .contact-admin a {
      color: #2575fc;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s;
    }

    .contact-admin a:hover {
      text-decoration: underline;
    }

    .back-button {
      display: block;
      text-align: center;
      margin-top: 20px;
      color: #666;
      text-decoration: none;
      font-size: 14px;
      transition: all 0.3s;
    }

    .back-button:hover {
      color: #2575fc;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Forgot Password Container -->
    <div class="forgot-container" id="forgotContainer">
      <div class="forgot-header">
        <h1>Forgot Password</h1>
      </div>

      <form class="forgot-form" id="forgotForm">
        <!-- Username -->
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" id="username" name="username" placeholder="Enter your username" required />
          <div class="error-message" id="usernameError">Please enter your username</div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" placeholder="Enter your email" required />
          <div class="error-message" id="emailError">Please enter a valid email</div>
        </div>

        <!-- Continue Button -->
        <button type="submit" class="continue-button" id="continueBtn">Continue</button>
        <div class="success-message" id="continueSuccess">Instructions sent to your email!</div>
      </form>
    </div>

    <!-- Recovery Options Container -->
    <div class="recovery-container" id="recoveryContainer">
      <div class="recovery-header">
        <h1>Recover Your Account</h1>
        <p>Choose how you'd like to reset your password</p>
      </div>

      <div class="recovery-options">
        <!-- Phone Option -->
        <div class="option-card" id="phoneOption">
          <div class="option-header">
            <div class="option-icon">üì±</div>
            <div class="option-title">Text me a reset code</div>
          </div>
          <div class="option-content">
            <div class="form-group">
              <label for="phone">Phone Number</label>
              <input
                type="text"
                id="phone"
                name="phone_number"
                placeholder="XXXX XX XXXX"
              />
              <div class="phone-format">
                Format: XXXX XX XXXX (e.g., 1234 56 7890)
              </div>
              <div class="error-message" id="phoneError">
                Please use the format XXXX XX XXXX
              </div>
            </div>
            <button class="send-button" onclick="sendSMS()">Send SMS</button>
            <div class="success-message" id="smsSuccess">Reset code sent to your phone!</div>
          </div>
        </div>

        <!-- Email Option -->
        <div class="option-card" id="emailOption">
          <div class="option-header">
            <div class="option-icon">‚úâÔ∏è</div>
            <div class="option-title">Email me a reset link</div>
          </div>
          <div class="option-content">
            <div class="form-group">
              <label for="recoveryEmail">Email Address</label>
              <input type="email" id="recoveryEmail" placeholder="Enter your email address" />
            </div>
            <button class="send-button" onclick="sendEmail()">Send Email</button>
            <div class="success-message" id="emailSuccess">Reset link sent to your email!</div>
          </div>
        </div>

        <!-- Contact Admin Option -->
        <div class="option-card" id="adminOption">
          <div class="option-header">
            <div class="option-icon">üë®‚Äçüíº</div>
            <div class="option-title">Contact Administrator</div>
          </div>
          <div class="option-content">
            <p style="margin-bottom: 15px; color: #666;">If you're having trouble resetting your password, our support team can help.</p>
            <button class="send-button" onclick="contactAdmin()">Contact Support</button>
            <div class="success-message" id="adminSuccess">Support request submitted!</div>
          </div>
        </div>

        <a href="#" class="back-button" onclick="goBackToForgot()">‚Üê Back</a>
      </div>
    </div>

    <!-- Verification Container -->
    <div class="verification-container" id="verificationContainer">
      <div class="verification-header">
        <h1>Verification Form</h1>
      </div>
      <div class="verification-form">
        <form id="verificationForm">
          <!-- Phone OTP (initially hidden) -->
          <div class="form-group" id="phoneOtpGroup" style="display: none;">
            <label for="phoneOtp">Enter Phone OTP</label>
            <div class="otp-boxes" id="phoneOtpBoxes">
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
            </div>
            <div class="error-message" id="phoneOtpError">
              Enter a valid 6-digit OTP
            </div>
          </div>

          <!-- Email OTP (initially hidden) -->
          <div class="form-group" id="emailOtpGroup" style="display: none;">
            <label for="emailOtp">Enter Email OTP</label>
            <div class="otp-boxes" id="emailOtpBoxes">
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
              <input type="text" maxlength="1" required />
            </div>
            <div class="error-message" id="emailOtpError">
              Enter a valid 6-digit OTP
            </div>
          </div>

          <!-- Password -->
          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" name="password" required />
            <span class="hint">(Min 5 chars, 1 capital, 1 special)</span>
            <div class="error-message" id="passError">
              password must contain Min 5 chars, 1 capital, 1 special
            </div>
          </div>

          <!-- Confirm Password -->
          <div class="form-group">
            <label for="confirmPassword">Confirm Password</label>
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              required
            />
            <div class="match-message" id="confirmMessage"></div>
          </div>

          <button type="submit" class="register-button">Reset Password</button>
        </form>
        <!-- Back button removed from verification container as requested -->
      </div>
    </div>
  </div>

  <script>
    // Track selected recovery method
    let selectedMethod = null;
    
    // DOM elements
    const forgotContainer = document.getElementById('forgotContainer');
    const recoveryContainer = document.getElementById('recoveryContainer');
    const verificationContainer = document.getElementById('verificationContainer');
    
    // Forgot password form submission
    document.getElementById('forgotForm').addEventListener('submit', function(e) {
      e.preventDefault();
      let isValid = true;

      // Username validation
      if (document.getElementById('username').value.trim() === "") {
        document.getElementById('usernameError').style.display = "block";
        document.getElementById('username').style.borderColor = "#d9534f";
        isValid = false;
      } else {
        document.getElementById('usernameError').style.display = "none";
        document.getElementById('username').style.borderColor = "#ddd";
      }

      // Email validation
      const email = document.getElementById('email');
      if (email.value.trim() === "" || !/\S+@\S+\.\S+/.test(email.value)) {
        document.getElementById('emailError').style.display = "block";
        email.style.borderColor = "#d9534f";
        isValid = false;
      } else {
        document.getElementById('emailError').style.display = "none";
        email.style.borderColor = "#ddd";
      }

      if (isValid) {
        // Show recovery options
        forgotContainer.style.display = 'none';
        recoveryContainer.style.display = 'block';
        
        // Pre-fill email in recovery options
        document.getElementById('recoveryEmail').value = email.value;
      }
    });

    // Recovery options functionality
    document.addEventListener("DOMContentLoaded", function () {
      // Get all option cards
      const optionCards = document.querySelectorAll('.option-card');
      
      // Add click event to each card
      optionCards.forEach(card => {
        card.addEventListener('click', function() {
          // Remove selected class from all cards
          optionCards.forEach(c => c.classList.remove('selected'));
          
          // Add selected class to clicked card
          this.classList.add('selected');
          
          // Store the selected method
          if (this.id === 'phoneOption') {
            selectedMethod = 'phone';
          } else if (this.id === 'emailOption') {
            selectedMethod = 'email';
          } else {
            selectedMethod = 'admin';
          }
        });
      });
    });

    function sendSMS() {
      const phone = document.getElementById('phone');
      const phoneError = document.getElementById('phoneError');
      
      // Validate phone number format (XXXX XX XXXX)
      const phonePattern = /^\d{4} \d{2} \d{4}$/;
      
      if (!phonePattern.test(phone.value)) {
        phoneError.style.display = 'block';
        phone.style.borderColor = '#d9534f';
        return;
      }
      
      phoneError.style.display = 'none';
      phone.style.borderColor = '#ddd';
      
      // Simulate sending SMS
      document.getElementById('smsSuccess').style.display = 'block';
      setTimeout(() => {
        document.getElementById('smsSuccess').style.display = 'none';
        showVerificationPage('phone');
      }, 1500);
    }

    function sendEmail() {
      const email = document.getElementById('recoveryEmail');
      if (email.value.trim() === '' || !/\S+@\S+\.\S+/.test(email.value)) {
        alert('Please enter a valid email address');
        return;
      }
      
      // Simulate sending email
      document.getElementById('emailSuccess').style.display = 'block';
      setTimeout(() => {
        document.getElementById('emailSuccess').style.display = 'none';
        showVerificationPage('email');
      }, 1500);
    }

    function contactAdmin() {
      // Simulate contacting admin
      document.getElementById('adminSuccess').style.display = 'block';
      setTimeout(() => {
        document.getElementById('adminSuccess').style.display = 'none';
      }, 3000);
    }

    function showVerificationPage(method) {
      recoveryContainer.style.display = 'none';
      verificationContainer.style.display = 'block';
      
      // Show only the OTP field for the selected method
      if (method === 'phone') {
        document.getElementById('phoneOtpGroup').style.display = 'block';
        document.getElementById('emailOtpGroup').style.display = 'none';
      } else if (method === 'email') {
        document.getElementById('phoneOtpGroup').style.display = 'none';
        document.getElementById('emailOtpGroup').style.display = 'block';
      }
      
      // Setup OTP fields
      setupOtp("phoneOtpBoxes");
      setupOtp("emailOtpBoxes");
    }

    function goBackToForgot() {
      recoveryContainer.style.display = 'none';
      forgotContainer.style.display = 'block';
    }

    // Verification page functionality
    function getOtpValue(containerId) {
      const inputs = document.querySelectorAll(`#${containerId} input`);
      return Array.from(inputs)
        .map((inp) => inp.value)
        .join("");
    }

    function setupOtp(containerId) {
      const inputs = document.querySelectorAll(`#${containerId} input`);
      inputs.forEach((input, index) => {
        input.addEventListener("input", () => {
          if (input.value.length === 1 && index < inputs.length - 1) {
            inputs[index + 1].focus();
          }
        });
        input.addEventListener("keydown", (e) => {
          if (e.key === "Backspace" && input.value === "" && index > 0) {
            inputs[index - 1].focus();
          }
        });
      });
    }

    const verificationForm = document.getElementById("verificationForm");
    const password = document.getElementById("password");
    const confirmPassword = document.getElementById("confirmPassword");
    const confirmMessage = document.getElementById("confirmMessage");

    // Password match check
    confirmPassword.addEventListener("input", () => {
      if (confirmPassword.value === "") {
        confirmMessage.style.display = "none";
        return;
      }
      if (password.value === confirmPassword.value) {
        confirmMessage.style.display = "block";
        confirmMessage.style.color = "green";
        confirmMessage.textContent = "Password matched";
      } else {
        confirmMessage.style.display = "block";
        confirmMessage.style.color = "red";
        confirmMessage.textContent = "Passwords do not match";
      }
    });

    verificationForm.addEventListener("submit", function (e) {
      let valid = true;

      // Validate OTP based on selected method
      if (selectedMethod === 'phone') {
        const phoneOtpVal = getOtpValue("phoneOtpBoxes");
        if (!/^\d{6}$/.test(phoneOtpVal)) {
          document.getElementById("phoneOtpError").style.display = "block";
          valid = false;
        } else {
          document.getElementById("phoneOtpError").style.display = "none";
        }
      } else if (selectedMethod === 'email') {
        const emailOtpVal = getOtpValue("emailOtpBoxes");
        if (!/^\d{6}$/.test(emailOtpVal)) {
          document.getElementById("emailOtpError").style.display = "block";
          valid = false;
        } else {
          document.getElementById("emailOtpError").style.display = "none";
        }
      }

      const passPattern = /^(?=.*[A-Z])(?=.*[\W_]).{5,}$/;
      if (!passPattern.test(password.value)) {
        document.getElementById("passError").style.display = "block";
        valid = false;
      } else {
        document.getElementById("passError").style.display = "none";
      }

      if (password.value !== confirmPassword.value) {
        confirmMessage.style.display = "block";
        confirmMessage.style.color = "red";
        confirmMessage.textContent = "Passwords do not match";
        valid = false;
      }

      if (valid) {
        e.preventDefault();
        alert('Password successfully reset! You can now login with your new password.');
        // In a real application, this would redirect to the login page
      } else {
        e.preventDefault();
      }
    });
  </script>
</body>
</html>
